<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>评分与胜率规则说明</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script>
    (function(){
      try {
        var theme = localStorage.getItem('theme') || 'light';
        var root = document.documentElement;
        if (theme === 'dark') root.setAttribute('data-theme', 'dark');
        else root.removeAttribute('data-theme');
      } catch (e) {}
    })();
  </script>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="header">
    <div class="container">
      <h1 class="title" id="infoTitle">规则说明</h1>
      <p class="subtitle" id="infoSubtitle">ELO 评分与胜率计算方法</p>
      <div style="margin-bottom:12px; display:flex; justify-content:flex-end">
        <select id="langSelect" class="select" title="切换语言">
          <option value="zh">中文</option>
          <option value="en">English</option>
          <option value="ja">日本語</option>
        </select>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="card" style="padding:16px 20px; line-height:1.8;">
      <h2 id="eloTitle">Glicko-2 参数</h2>
      <div id="eloIntro" style="line-height:1.9;">
        <p>每个模型都拥有三个核心 Glicko-2 参数：</p>
        <ul>
          <li><strong>评分 (Rating, μ)</strong>：代表模型的实力值，类似于 Elo 分数。初始值通常为 1500。</li>
          <li><strong>评分偏差 (Rating Deviation, RD, φ)</strong>：衡量模型评分的不确定性。RD 越高，表示系统对该模型的真实实力越不确定。新模型的 RD 会很高，而参赛次数多的模型的 RD 会逐渐降低。</li>
          <li><strong>评分波动率 (Rating Volatility, σ)</strong>：衡量模型实力表现的稳定性。表现时好时坏、经常爆冷或被爆冷的模型，其波动率会较高。</li>
        </ul>
        <p>一场比赛的结果不仅会改变双方的评分，还会根据比赛的意外程度调整他们的 RD 和波动率。</p>
      </div>

      <h2 id="wrTitle">胜率</h2>
      <pre class="muted" id="wrFormula" style="white-space:pre-wrap;">胜率(%) = (胜场 + 0.5 * 平局) / 对战总数 * 100</pre>
      <p id="wrNote">平局计作半场胜利。</p>

      <p><a class="link" id="backLink" href="./">返回排行榜</a></p>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <span class="muted" id="infoFooter">由 GitHub Actions 定时同步 · 开源部署于 GitHub Pages</span>
    </div>
  </footer>
  <script>
    (function(){
      var I18N = {
        zh: {
          htmlLang: 'zh-CN',
          title: '规则说明',
          subtitle: 'Glicko-2 参数与胜率',
          eloTitle: 'Glicko-2 参数',
          eloIntro: `
            <p>每个模型都拥有三个核心 Glicko-2 参数：</p>
            <ul>
              <li><strong>评分 (Rating, μ)</strong>：代表模型的实力值，类似于 Elo 分数。初始值通常为 1500。</li>
              <li><strong>评分偏差 (Rating Deviation, RD, φ)</strong>：衡量模型评分的不确定性。RD 越高，表示系统对该模型的真实实力越不确定。新模型的 RD 会很高，而参赛次数多的模型的 RD 会逐渐降低。</li>
              <li><strong>评分波动率 (Rating Volatility, σ)</strong>：衡量模型实力表现的稳定性。表现时好时坏、经常爆冷或被爆冷的模型，其波动率会较高。</li>
            </ul>
            <p>一场比赛的结果不仅会改变双方的评分，还会根据比赛的意外程度调整他们的 RD 和波动率。</p>
          `,
          eloFormula: '',
          wrTitle: '胜率',
          wrFormula: '胜率(%) = (胜场 + 0.5 * 平局) / 对战总数 * 100',
          wrNote: '平局计作半场胜利。',
          back: '返回排行榜',
          footer: '由 GitHub Actions 定时同步 · 开源部署于 GitHub Pages',
          langTitle: '切换语言'
        },
        en: {
          htmlLang: 'en',
          title: 'Rules',
          subtitle: 'Glicko-2 and win rate',
          eloTitle: 'Glicko-2 Parameters',
          eloIntro: `
            <p>Each model has three core Glicko-2 parameters:</p>
            <ul>
              <li><strong>Rating (μ)</strong>: Represents model skill, similar to Elo. The typical initial value is 1500.</li>
              <li><strong>Rating Deviation (RD, φ)</strong>: Measures the uncertainty of the rating. A higher RD indicates more uncertainty about true skill. New models start with high RD, and RD decreases as more matches are played.</li>
              <li><strong>Rating Volatility (σ)</strong>: Measures stability of performance. Models with inconsistent performance and frequent upsets tend to have higher volatility.</li>
            </ul>
            <p>A match result updates both players’ ratings and also adjusts RD and volatility depending on how surprising the outcome is.</p>
          `,
          eloFormula: '',
          wrTitle: 'Win Rate',
          wrFormula: 'WinRate(%) = (Wins + 0.5 * Draws) / Total * 100',
          wrNote: 'A draw counts as half a win.',
          back: 'Back to leaderboard',
          footer: 'Synced by GitHub Actions · Deployed on GitHub Pages',
          langTitle: 'Change language'
        },
        ja: {
          htmlLang: 'ja',
          title: 'ルール',
          subtitle: 'Glicko-2 パラメータと勝率',
          eloTitle: 'Glicko-2 パラメータ',
          eloIntro: `
            <p>各モデルには 3 つの中核的な Glicko-2 パラメータがあります。</p>
            <ul>
              <li><strong>レーティング（μ）</strong>: モデルの実力値を表し、Elo スコアに類似します。初期値は通常 1500 です。</li>
              <li><strong>レーティング偏差（RD, φ）</strong>: レーティングの不確実性を表します。RD が高いほど真の実力に対する不確実性が大きいことを意味します。新規モデルは RD が高く、対戦数が増えるにつれて RD は低下していきます。</li>
              <li><strong>変動率（σ）</strong>: 実力の安定性を表します。好不調の波が大きく、番狂わせが多いモデルは変動率が高くなります。</li>
            </ul>
            <p>対戦結果は両者のレーティングを更新するだけでなく、結果の意外性に応じて RD と変動率も調整されます。</p>
          `,
          eloFormula: '',
          wrTitle: '勝率',
          wrFormula: '勝率(%) = (勝 + 0.5 * 引分) / 総対戦数 * 100',
          wrNote: '引き分けは半勝として計算します。',
          back: 'ランキングへ戻る',
          footer: 'GitHub Actions により同期 · GitHub Pages にデプロイ',
          langTitle: '言語を切り替え'
        }
      };

      function getLang(){
        try { return localStorage.getItem('lang') || 'zh'; } catch(_) { return 'zh'; }
      }
      function apply(lang){
        var T = I18N[lang] || I18N.zh;
        try { document.documentElement.lang = T.htmlLang; } catch(e) {}
        try { localStorage.setItem('lang', lang); } catch(e) {}
        var s = function(id, val){ var el = document.getElementById(id); if(!el) return; if(id === 'infoTitle') el.textContent = val; else el.textContent = val; };
        s('infoTitle', T.title);
        s('infoSubtitle', T.subtitle);
        s('eloTitle', T.eloTitle);
        var ei = document.getElementById('eloIntro'); if (ei) ei.innerHTML = T.eloIntro || '';
        var ef = document.getElementById('eloFormula'); if (ef) ef.textContent = T.eloFormula;
        s('wrTitle', T.wrTitle);
        var wf = document.getElementById('wrFormula'); if (wf) wf.textContent = T.wrFormula;
        s('wrNote', T.wrNote);
        var back = document.getElementById('backLink'); if (back) back.textContent = T.back;
        var footer = document.getElementById('infoFooter'); if (footer) footer.textContent = T.footer;
        var sel = document.getElementById('langSelect'); if (sel) sel.title = T.langTitle;
        var select = document.getElementById('langSelect'); if (select && select.value !== lang) select.value = lang;
      }
      document.addEventListener('DOMContentLoaded', function(){
        var sel = document.getElementById('langSelect');
        if (sel) sel.addEventListener('change', function(e){ apply(e.target && e.target.value ? e.target.value : 'zh'); });
        apply(getLang());
      });
    })();
  </script>
</body>
</html>
